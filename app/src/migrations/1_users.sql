CREATE TABLE INVITATION_CODES (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  VALUE TEXT NOT NULL UNIQUE
);

CREATE TABLE USERS (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  USERNAME TEXT NOT NULL UNIQUE,
  EMAIL TEXT NOT NULL UNIQUE,
  PASSWORD TEXT NOT NULL,
  REGISTRATION_DATETIME TIMESTAMP DEFAULT NOW(),
  VERIFIED BOOLEAN DEFAULT FALSE,
  VERIFICATION_TOKEN TEXT NOT NULL UNIQUE,
  INVITATION_CODE_ID BIGINT UNIQUE,
  FOREIGN KEY(INVITATION_CODE_ID) REFERENCES INVITATION_CODES(ID)
);

CREATE TABLE USERS_SESSIONS (
  ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  USER_ID BIGINT NOT NULL,
  USER_AGENT TEXT NOT NULL,
  IP_ADDRESS TEXT NOT NULL,
  ACCESS_TOKEN TEXT DEFAULT NULL UNIQUE,
  ACCESS_TOKEN_GENERATION_DATETIME TIMESTAMP DEFAULT NULL,
  FOREIGN KEY(USER_ID) REFERENCES USERS(ID)
);

